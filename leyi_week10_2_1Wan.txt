##############################
Regenie 模板
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12_label.pheno \
  --covarFile ${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC.covars \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --out ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Trait12_NEW_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12_label.pheno \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --qt \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Trait12_NEW_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Trait12_NEW_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Regenie/Result_NEW_regenie_s1and2_Trait12


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Regenie

sbatch Result_NEW_regenie_s1and2_Trait12


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC.covars --qCovarCol=PC{1:20}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Bolt_Trait12_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Bolt_lmm/Result_Bolt_Trait12_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Bolt_lmm/

sbatch Result_Bolt_Trait12_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC.covars --qCovarCol=PC{1:20}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Bolt_inf_Trait12_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait12_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait12_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --linear hide-covar --covar ${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_Plink_Trait12_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Plink/Result_Plink_Trait12_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_Plink

sbatch Result_Plink_Trait12_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/ldak5.XXX --pheno ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Trait_1Wan_12.pheno  --mpheno $j --covar ${dir}/type_1_error/Multi_Traits/Traits_1Wan/covar_1Wan_PC_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_qc --linear ${dir}/type_1_error/Multi_Traits/Traits_1Wan/Result_Trait12/Result_LDAK_Trait_12_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_LDAK/Result_LDAK_Trait12_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Traits_1Wan/Result_LDAK/
sbatch Result_LDAK_Trait12_P$j
done





















































######################################
Simulate data 13-24: LDAK
######################################
############# 13-24 Trait_qt_1Wan_LDAK_h01-09_K-10K_13-24
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 16G
#SBATCH -t 30:0:0
#SBATCH -c 8
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh


${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_13 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt


  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_14 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_15 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_16 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_17 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_18 \
  --bfile ${dir}/data_qc \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_7Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_19 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

  " > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24/Trait_qt_LDAK_13to19

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24
sbatch Trait_qt_LDAK_13to19

##############################################################################3
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 16G
#SBATCH -t 30:0:0
#SBATCH -c 8
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_20 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_21 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 10000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_22 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_23 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

  ${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/Trait_13_to_24/Trait_24 \
  --bfile ${dir}/MAMA/Bolt_Height/data_Black \
  --ignore-weights YES \
  --power -0.25 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 1000 \
  --max-threads 8 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt





" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24/Trait_qt_LDAK_20to24

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24
sbatch Trait_qt_LDAK_20to24