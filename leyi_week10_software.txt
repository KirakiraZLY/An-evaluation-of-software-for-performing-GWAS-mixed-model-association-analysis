###############################
1. Redo on trait 3 regenie




###############################

###############################
Redo on Trait 3
第三个的regenie
###############################
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 3:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_qc \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h09_K_3_label.pheno \
  --covarFile ${dir}/covar_PC.covars \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_regenie_qt_7Wan_GCTA_h09_K_3_s1 


regenie \
  --step 2 \
  --bgen ${dir}/data_qc.bgen \
  --covarFile ${dir}/covar_PC.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h09_K_3_label.pheno \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --qt \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_regenie_qt_7Wan_GCTA_h09_K_3_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_regenie_qt_7Wan_GCTA_h09_K_3_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_regenie_qt_7Wan_GCTA_h09_K_3_s1and2 

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/

sbatch Result_regenie_qt_7Wan_GCTA_h09_K_3_s1and2 


####################################333
LDAK 6
#######################################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 3:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/ldak5.XXX --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h09_10K_6.pheno --mpheno $j --covar ${dir}/covar_PC_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_qc --linear ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/Result_ldak_qt_7Wan_GCTA_h09_10K_6_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/Result_ldak_qt_7Wan_GCTA_h09_10K_6_P$j

cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/

sbatch Result_ldak_qt_7Wan_GCTA_h09_10K_6_P$j
done



####################################333
LDAK 2
#######################################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 3:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/ldak5.XXX --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h05_K_2.pheno --mpheno $j --covar ${dir}/covar_PC_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_qc --linear ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/Result_ldak_inf_qt_7Wan_GCTA_h05_K_2_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/Result_ldak_inf_qt_7Wan_GCTA_h05_K_2_P$j

cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/

sbatch Result_ldak_inf_qt_7Wan_GCTA_h05_K_2_P$j
done



##########################################
Plink test for all first 12
##########################################
###############
第一个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h01_K_1.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_K_1/Result_plink_qt_7Wan_GCTA_h01_K_1_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_K_1/Result_plink_qt_7Wan_GCTA_h01_K_1_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_K_1/

sbatch Result_plink_qt_7Wan_GCTA_h01_K_1_P$j
done


###############
第二个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h05_K_2.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/Result_plink_qt_7Wan_GCTA_h05_K_2_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/Result_plink_inf_qt_7Wan_GCTA_h05_K_2_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_K_2/

sbatch Result_plink_inf_qt_7Wan_GCTA_h05_K_2_P$j
done


############3
第三个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h09_K_3.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_plink_qt_7Wan_GCTA_h09_K_3_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/Result_plink_qt_7Wan_GCTA_h09_K_3_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_K_3/

sbatch Result_plink_qt_7Wan_GCTA_h09_K_3_P$j
done




###############
第四个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h01_10K_4.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_10K_4/Result_plink_qt_7Wan_GCTA_h01_10K_4_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_10K_4/Result_plink_qt_7Wan_GCTA_h01_10K_4_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h01_10K_4/

sbatch Result_plink_qt_7Wan_GCTA_h01_10K_4_P$j
done




###############
第五个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h05_10K_5.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_10K_5/Result_plink_qt_7Wan_GCTA_h05_10K_5_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_10K_5/Result_plink_qt_7Wan_GCTA_h05_10K_5_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h05_10K_5/

sbatch Result_plink_qt_7Wan_GCTA_h05_10K_5_P$j
done




###############
第六个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_7Wan_GCTA_h09_10K_6.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/Result_plink_qt_7Wan_GCTA_h09_10K_6_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/Result_plink_qt_7Wan_GCTA_h09_10K_6_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_7Wan_GCTA_h09_10K_6/

sbatch Result_plink_qt_7Wan_GCTA_h09_10K_6_P$j
done






###############
第七个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h01_K_7.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_K_7/Result_plink_qt_1Wan_GCTA_h01_K_7_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_K_7/Result_plink_qt_1Wan_GCTA_h01_K_7_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_K_7/

sbatch Result_plink_qt_1Wan_GCTA_h01_K_7_P$j
done





###############
第八个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h05_K_8.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_K_8/Result_plink_qt_1Wan_GCTA_h05_K_8_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_K_8/Result_plink_qt_1Wan_GCTA_h05_K_8_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_K_8/

sbatch Result_plink_qt_1Wan_GCTA_h05_K_8_P$j
done



###############
第九个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h09_K_9.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_K_9/Result_plink_qt_1Wan_GCTA_h09_K_9_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_K_9/Result_plink_qt_1Wan_GCTA_h09_K_9_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_K_9/

sbatch Result_plink_qt_1Wan_GCTA_h09_K_9_P$j
done






###############
第十个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h01_10K_10.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_10K_10/Result_plink_qt_1Wan_GCTA_h01_10K_10_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_10K_10/Result_plink_qt_1Wan_GCTA_h01_10K_10_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h01_10K_10/

sbatch Result_plink_qt_1Wan_GCTA_h01_10K_10_P$j
done





###############
第十一个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h05_10K_11.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_10K_11/Result_plink_qt_1Wan_GCTA_h05_10K_11_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_10K_11/Result_plink_qt_1Wan_GCTA_h05_10K_11_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h05_10K_11/

sbatch Result_plink_qt_1Wan_GCTA_h05_10K_11_P$j
done






###############
第十二个
###############
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_qt_1Wan_GCTA_h09_10K_12.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_10K_12/Result_plink_qt_1Wan_GCTA_h09_10K_12_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_10K_12/Result_plink_qt_1Wan_GCTA_h09_10K_12_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Result_Trait_qt_1Wan_GCTA_h09_10K_12/

sbatch Result_plink_qt_1Wan_GCTA_h09_10K_12_P$j
done





####################################3
Make 10K(1Wan) random data
######################################
############ Step 2###########
dir="/home/lezh/dsmwpred/zly"
${dir}/software/plink --bfile ${dir}/data_qc --noweb --keep ${dir}/data_1Wan.fam --recode --make-bed --out ${dir}/data_1Wan













######################################
Simulate data 7-12 NEW
用新的1万人来generate phenotypes
######################################
##########
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 16G
#SBATCH -t 30:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_7 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 1000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_8 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 1000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_9 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 1000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_10 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.1 \
  --num-phenos 5 \
  --num-causals 10000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt


${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_11 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.5 \
  --num-phenos 5 \
  --num-causals 10000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

${dir}/software/ldak5.XXX \
  --make-phenos ${dir}/type_1_error/Multi_Traits/1Wan_Traits/Trait_1Wan_12 \
  --bfile ${dir}/data_1Wan \
  --ignore-weights YES \
  --power -1 \
  --her 0.9 \
  --num-phenos 5 \
  --num-causals 10000 \
  --extract ${dir}/type_1_error/Multi_Traits/snps_1_to_12_1Wan.txt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/1Wan_Traits/Trait_1Wan_7to12

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/1Wan_Traits
sbatch Trait_1Wan_7to12















#################################################
#################################################
############################################
Software test: Trait_qt_7Wan_LDAK_h01_1K_13
第7个trait
############################################
dir="/home/lezh/dsmwpred/zly"
${dir}/software/plink2 --bfile ${dir}/data_1Wan --export bgen-1.2 --out ${dir}/data_1Wan

##############################
Regenie
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_qc \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13_label.pheno \
  --covarFile ${dir}/covar_PC.covars \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --out ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_regenie_qt_7Wan_LDAK_h01_1K_13_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_qc.bgen \
  --covarFile ${dir}/covar_PC.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13_label.pheno \
  --covarCol PC{1:20} \
  --bsize 1000 \
  --threads 4 \
  --qt \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_regenie_qt_7Wan_LDAK_h01_1K_13_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_regenie_qt_7Wan_LDAK_h01_1K_13_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_13_regenie_qt_7Wan_LDAK_h01_1K_s1and2 

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/

sbatch Result_13_regenie_qt_7Wan_LDAK_h01_1K_s1and2 


##############################
Bolt
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_qc --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13_label.pheno  --phenoCol=Phenotype$j  --covarFile=${dir}/covar_PC.covars --qCovarCol=PC{1:20}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_Bolt_qt_7Wan_LDAK_h01_1K_13_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_13_bolt_qt_7Wan_LDAK_h01_1K_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K

sbatch Result_13_bolt_qt_7Wan_LDAK_h01_1K_P$j
done

##############################
Bolt-inf
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 8
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_qc --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13_label.pheno  --phenoCol=Phenotype$j --covarFile=${dir}/covar_PC.covars --qCovarCol=PC{1:20}  --lmmInfOnly --LDscoresUseChip --numThreads 4 --statsFile=${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_Bolt_inf_qt_7Wan_LDAK_h01_1K_13_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_13_bolt_inf_qt_7Wan_LDAK_h01_1K_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/

sbatch Result_13_bolt_inf_qt_7Wan_LDAK_h01_1K_P$j
done


##############################
Plink
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 5:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_qc --linear hide-covar --covar ${dir}/covar_PC_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13_label.pheno --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_Plink_qt_7Wan_LDAK_h01_1K_13_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_13_Plink_qt_7Wan_LDAK_h01_1K_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/

sbatch Result_13_Plink_qt_7Wan_LDAK_h01_1K_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 2:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/ldak5.XXX --pheno ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Trait_qt_7Wan_LDAK_h01_K_13.pheno --mpheno $j --covar ${dir}/covar_PC_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_qc --linear ${dir}/type_1_error/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_LDAK_qt_7Wan_LDAK_h01_1K_13_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/Result_13_LDAK_qt_7Wan_LDAK_h01_1K_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_13_to_24_LDAK/Result_Trait13_qt_7Wan_LDAK_h01_K/

sbatch Result_13_LDAK_qt_7Wan_LDAK_h01_1K_P$j
done