##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Trait31_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Trait31_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Trait31_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait31


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait31


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Bolt_Trait31_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait31_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait31_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Bolt_inf_Trait31_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait31_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait31_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_Plink_Trait31_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait31_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait31_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_LDAK_Trait_31_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait31_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait31_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_31.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait31/Result_fastGWA_Trait31_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait31_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait31_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Trait32_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Trait32_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Trait32_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait32


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait32


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Bolt_Trait32_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait32_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait32_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Bolt_inf_Trait32_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait32_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait32_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_Plink_Trait32_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait32_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait32_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_LDAK_Trait_32_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait32_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait32_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_32.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait32/Result_fastGWA_Trait32_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait32_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait32_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Trait33_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Trait33_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Trait33_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait33


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait33


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Bolt_Trait33_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait33_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait33_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Bolt_inf_Trait33_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait33_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait33_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_Plink_Trait33_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait33_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait33_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_LDAK_Trait_33_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait33_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait33_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_33.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait33/Result_fastGWA_Trait33_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait33_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait33_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Trait34_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Trait34_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Trait34_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait34


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait34


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Bolt_Trait34_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait34_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait34_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Bolt_inf_Trait34_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait34_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait34_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_Plink_Trait34_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait34_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait34_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_LDAK_Trait_34_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait34_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait34_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_34.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait34/Result_fastGWA_Trait34_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait34_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait34_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Trait35_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Trait35_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Trait35_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait35


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait35


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Bolt_Trait35_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait35_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait35_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Bolt_inf_Trait35_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait35_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait35_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_Plink_Trait35_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait35_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait35_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_LDAK_Trait_35_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait35_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait35_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_35.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait35/Result_fastGWA_Trait35_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait35_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait35_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Trait36_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Trait36_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Trait36_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait36


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait36


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Bolt_Trait36_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait36_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait36_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Bolt_inf_Trait36_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait36_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait36_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_Plink_Trait36_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait36_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait36_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_LDAK_Trait_36_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait36_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait36_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_36.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait36/Result_fastGWA_Trait36_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait36_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait36_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Trait43_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Trait43_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Trait43_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait43


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait43


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Bolt_Trait43_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait43_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait43_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Bolt_inf_Trait43_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait43_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait43_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_Plink_Trait43_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait43_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait43_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_LDAK_Trait_43_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait43_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait43_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_43.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait43/Result_fastGWA_Trait43_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait43_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait43_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Trait44_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Trait44_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Trait44_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait44


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait44


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Bolt_Trait44_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait44_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait44_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Bolt_inf_Trait44_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait44_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait44_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_Plink_Trait44_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait44_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait44_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_LDAK_Trait_44_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait44_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait44_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_44.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait44/Result_fastGWA_Trait44_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait44_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait44_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Trait45_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Trait45_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Trait45_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait45


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait45


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Bolt_Trait45_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait45_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait45_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Bolt_inf_Trait45_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait45_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait45_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_Plink_Trait45_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait45_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait45_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_LDAK_Trait_45_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait45_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait45_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_45.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait45/Result_fastGWA_Trait45_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait45_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait45_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Trait46_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Trait46_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Trait46_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait46


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait46


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Bolt_Trait46_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait46_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait46_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Bolt_inf_Trait46_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait46_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait46_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_Plink_Trait46_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait46_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait46_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_LDAK_Trait_46_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait46_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait46_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_46.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait46/Result_fastGWA_Trait46_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait46_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait46_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Trait47_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Trait47_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Trait47_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait47


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait47


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Bolt_Trait47_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait47_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait47_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Bolt_inf_Trait47_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait47_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait47_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_Plink_Trait47_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait47_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait47_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_LDAK_Trait_47_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait47_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait47_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_47.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait47/Result_fastGWA_Trait47_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait47_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait47_P$j
done

##############################
##############################
Regenie 模板
31-36 & 43-48
##############################
########### 1 #############
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred

source /home/lezh/miniconda3/etc/profile.d/conda.sh
conda activate regenie_env

regenie \
  --step 1 \
  --bed ${dir}/data_1Wan \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48_label.pheno \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Trait48_regenie_s1  


regenie \
  --step 2 \
  --bgen ${dir}/data_1Wan.bgen \
  --covarFile ${dir}/covar_1Wan_PC_10.covars \
  --phenoFile ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48_label.pheno \
  --covarCol PC{1:10} \
  --bsize 1000 \
  --threads 4 \
  --bt \
  --firth --approx \
  --pThresh 0.01 \
  --pred ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Trait48_regenie_s1_pred.list \
  --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Trait48_regenie_s2

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie/Result_regenie_s1and2_Trait48


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Regenie

sbatch Result_regenie_s1and2_Trait48


##############################
Bolt
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmForceNonInf --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Bolt_Trait48_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/Result_Bolt_Trait48_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm/

sbatch Result_Bolt_Trait48_P$j
done


##############################
Bolt-inf
##############################

for j in {1..5};do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/BOLT-LMM_v2.4/bolt --bfile=${dir}/data_1Wan --phenoFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48_label.pheno   --phenoCol=Phenotype$j  --covarFile=${dir}/covar_1Wan_PC_10.covars --qCovarCol=PC{1:10}  --lmmInfOnly --LDscoresUseChip --numThreads 4  --statsFile=${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Bolt_inf_Trait48_P$j.Bolt

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/Result_Bolt_inf_Trait48_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Bolt_lmm_inf/

sbatch Result_Bolt_inf_Trait48_P$j

done


##############################
Plink
##############################

for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 2G
#SBATCH -t 10:0:0
#SBATCH -c 1
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir}/software/plink --bfile ${dir}/data_1Wan --logistic hide-covar --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48.pheno  --mpheno $j --allow-no-sex --memory 2048 --out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_Plink_Trait48_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink/Result_Plink_Trait48_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Plink

sbatch Result_Plink_Trait48_P$j
done

##############################
LDAK
##############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
dir_LDAK="/home/lezh/snpher/faststorage/ldak5.2.linux"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 4
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"


source /home/lezh/miniconda3/etc/profile.d/conda.sh

${dir_LDAK} --pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48.pheno  --mpheno $j --covar ${dir}/covar_1Wan_PC_10_withoutLabel.covars --max-threads 4  --bfile ${dir}/data_1Wan --logistic ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_LDAK_Trait_48_P$j

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/Result_LDAK_Trait48_P$j

# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_LDAK/
sbatch Result_LDAK_Trait48_P$j
done



#############################
fastGWA Step 3 for data_1Wan
#############################
for j in {1..5}; do 
dir="/home/lezh/dsmwpred/zly"
echo "#"'!'"/bin/bash
#SBATCH --mem 8G
#SBATCH -t 4:0:0
#SBATCH -c 10
#SBATCH -A dsmwpred
#SBATCH --constraint \"s05\"

${dir}/software/gcta --bfile ${dir}/data_1Wan \
--grm-sparse ${dir}/data_1Wan_gcta_2 \
--fastGWA-mlm \
--pheno ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Trait_48.pheno \
--mpheno $j \
--qcovar ${dir}/covar_1Wan_PC_10.covars \
--out ${dir}/type_1_error/Multi_Traits/Trait_25_to_48_Binary_P015/Result_Trait48/Result_fastGWA_Trait48_P$j \
--thread-num 10

" > ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA/Result_fastGWA_Trait48_P$j


# I am doing blabla
cd ${dir}/scripts/type_1_error_new/Multi_Traits/Trait_25_to_48_Binary_P015/Result_fastGWA

sbatch Result_fastGWA_Trait48_P$j
done