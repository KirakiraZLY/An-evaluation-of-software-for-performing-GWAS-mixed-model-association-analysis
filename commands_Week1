# Commands for Master's thesis
## Week 1
https://zhuanlan.zhihu.com/p/380709653   
### Download nextflow
https://github.com/genepi/nf-gwas   
https://www.nextflow.io/docs/latest/getstarted.html#installation   

### fastGWA
https://yanglab.westlake.edu.cn/software/gcta/#fastGWA   
1. After download, see: **gcta** in dsmwpred/zly/software   
2. GCTA-GRM: calculating the genetic relationship matrix (GRM) from all the autosomal SNPs:   
./software/gcta --bfile data_qc --chr 1 --maf 0.01 --make-grm --out data_qc_chr1 --thread-num 10  
./software/gcta --bfile data_qc --chr 2 --maf 0.01 --make-grm --out data_qc_chr2 --thread-num 10
...
./software/gcta --bfile data_qc --chr 22 --maf 0.01 --make-grm --out data_qc_chr22 --thread-num 10
Output: .grm.bin, .grm.N.bin, .grm.id   
3. To generate a sparse GRM from SNP data:
./software/gcta --bfile data_qc --autosome --maf 0.01 --make-grm --out data_qc_gcta --thread-num 10   
./software/gcta --grm data_qc_gcta --make-bK-sparse 0.05 --out sp_grm_gcta   

I didn't use PCs
./software/gcta --mbfile data_qc --grm-sparse sp_grm_gcta --fastGWA-mlm --pheno height.pheno --covar fixed.txt --thread-num 10 --out geno_assoc

### Regenie
1. regenie \
  --step 1 \
  --bed data_qc \
  --covarFile covar1.covars \
  --phenoFile height1.pheno \
  --bsize 100 \
  --out data_regenie_out
  因为.pheno需要FID和IID，就复制了一个height1.pheno文件并更改格式。